{
  "m_q": {
    "target_metric": "Average annual difference in number of fires reported by NOAA compared to NIFC since 2000, rounded to nearest whole number",
    "filters": [
      "Date >= 200001",
      "Year >= 2000"
    ],
    "grouping_variables": [
      "Year"
    ],
    "output_cardinality": "scalar",
    "sub_questions": [
      "What is the annual total number of fires from NOAA monthly data?",
      "What is the annual number of fires from NIFC data?",
      "What is the difference between NOAA and NIFC annual fire counts for each year since 2000?",
      "What is the average of these annual differences?"
    ]
  },
  "m_s": {
    "sources": [
      "noaa_wildfires_monthly_stats.csv",
      "nifc_wildfires.csv"
    ],
    "join_keys": [
      {
        "left_source": "noaa_wildfires_monthly_stats.csv",
        "right_source": "nifc_wildfires.csv",
        "left_column": "Year",
        "right_column": "Year",
        "join_type": "inner"
      }
    ],
    "schema_conflicts": [
      "NOAA data has monthly granularity while NIFC data appears to be annual",
      "NOAA Date column is in YYYYMM format while NIFC year column needs extraction",
      "NIFC column names appear corrupted with tab characters and mixed data types"
    ],
    "column_mappings": {
      "Date": "YearMonth",
      "2024\t64": "Year_Fires_Acres",
      "Number of Fires": "NOAA_Fires_Monthly"
    }
  },
  "m_u": {
    "unit_annotations": {
      "Date": "YYYYMM integer",
      "Acres Burned": "acres",
      "Number of Fires": "count of fires",
      "Acres Burned per Fire": "acres per fire"
    },
    "scale_issues": [
      "NOAA data is monthly, NIFC data appears to be annual - need to aggregate NOAA to annual totals",
      "NIFC data appears to combine year, fire count, and acres in single column with tab separation"
    ],
    "cross_source_conflicts": [
      "NOAA reports monthly fire counts while NIFC appears to report annual totals directly",
      "NIFC data format suggests fire counts and acres are combined in same column with tab separator"
    ]
  },
  "m_f": {
    "has_header": true,
    "delimiter": ",",
    "encoding": "utf-8",
    "sentinel_values": [
      "Missing:-999",
      "*",
      "-999"
    ],
    "expected_columns": 4,
    "expected_rows": 0,
    "file_format": "csv",
    "format_notes": [
      "NOAA file has clean CSV format",
      "NIFC file appears to have tab characters within columns causing parsing issues",
      "NIFC column '2024\t64' suggests tab-separated year and fire count",
      "NIFC row '2007\t85,705\t9,328,45' has inconsistent thousands separators",
      "NIFC row '2004\t65,461\t*8,97,880' contains asterisk and inconsistent formatting"
    ]
  },
  "m_c": {
    "constraints": [
      "Only include years >= 2000",
      "NOAA data needs annual aggregation from monthly values",
      "NIFC data needs parsing to extract year and fire count from combined columns",
      "Round final result to nearest whole number"
    ],
    "derived_filters": [
      "Filter NOAA data where Date >= 200001",
      "Filter NIFC data where Year >= 2000",
      "Exclude rows with sentinel values like '*', '-999'"
    ],
    "statistical_tests": [
      "Check for missing years in either dataset",
      "Validate that NOAA annual sums are reasonable compared to NIFC annual values",
      "Check for outliers in annual differences"
    ],
    "output_format_requirements": [
      "Final output should be a single integer rounded to nearest whole number",
      "Calculation: average(NOAA_annual_fires - NIFC_annual_fires) for years >= 2000"
    ]
  },
  "raw_text": "```json\n{\n    \"M_Q\": {\n        \"target_metric\": \"Average annual difference in number of fires reported by NOAA compared to NIFC since 2000, rounded to nearest whole number\",\n        \"filters\": [\"Date >= 200001\", \"Year >= 2000\"],\n        \"grouping_variables\": [\"Year\"],\n        \"output_cardinality\": \"scalar\",\n        \"sub_questions\": [\"What is the annual total number of fires from NOAA monthly data?\", \"What is the annual number of fires from NIFC data?\", \"What is the difference between NOAA and NIFC annual fire counts for each year since 2000?\", \"What is the average of these annual differences?\"]\n    },\n    \"M_S\": {\n        \"sources\": [\"noaa_wildfires_monthly_stats.csv\", \"nifc_wildfires.csv\"],\n        \"join_keys\": [{\"left_source\": \"noaa_wildfires_monthly_stats.csv\", \"right_source\": \"nifc_wildfires.csv\", \"left_column\": \"Year\", \"right_column\": \"Year\", \"join_type\": \"inner\"}],\n        \"schema_conflicts\": [\"NOAA data has monthly granularity while NIFC data appears to be annual\", \"NOAA Date column is in YYYYMM format while NIFC year column needs extraction\", \"NIFC column names appear corrupted with tab characters and mixed data types\"],\n        \"column_mappings\": {\"Date\": \"YearMonth\", \"2024\\t64\": \"Year_Fires_Acres\", \"Number of Fires\": \"NOAA_Fires_Monthly\"}\n    },\n    \"M_U\": {\n        \"unit_annotations\": {\"Date\": \"YYYYMM integer\", \"Acres Burned\": \"acres\", \"Number of Fires\": \"count of fires\", \"Acres Burned per Fire\": \"acres per fire\"},\n        \"scale_issues\": [\"NOAA data is monthly, NIFC data appears to be annual - need to aggregate NOAA to annual totals\", \"NIFC data appears to combine year, fire count, and acres in single column with tab separation\"],\n        \"cross_source_conflicts\": [\"NOAA reports monthly fire counts while NIFC appears to report annual totals directly\", \"NIFC data format suggests fire counts and acres are combined in same column with tab separator\"]\n    },\n    \"M_F\": {\n        \"has_header\": true,\n        \"delimiter\": \",\",\n        \"encoding\": \"utf-8\",\n        \"sentinel_values\": [\"Missing:-999\", \"*\", \"-999\"],\n        \"expected_columns\": 4,\n        \"file_format\": \"csv\",\n        \"format_notes\": [\"NOAA file has clean CSV format\", \"NIFC file appears to have tab characters within columns causing parsing issues\", \"NIFC column '2024\\t64' suggests tab-separated year and fire count\", \"NIFC row '2007\\t85,705\\t9,328,45' has inconsistent thousands separators\", \"NIFC row '2004\\t65,461\\t*8,97,880' contains asterisk and inconsistent formatting\"]\n    },\n    \"M_C\": {\n        \"constraints\": [\"Only include years >= 2000\", \"NOAA data needs annual aggregation from monthly values\", \"NIFC data needs parsing to extract year and fire count from combined columns\", \"Round final result to nearest whole number\"],\n        \"derived_filters\": [\"Filter NOAA data where Date >= 200001\", \"Filter NIFC data where Year >= 2000\", \"Exclude rows with sentinel values like '*', '-999'\"],\n        \"statistical_tests\": [\"Check for missing years in either dataset\", \"Validate that NOAA annual sums are reasonable compared to NIFC annual values\", \"Check for outliers in annual differences\"],\n        \"output_format_requirements\": [\"Final output should be a single integer rounded to nearest whole number\", \"Calculation: average(NOAA_annual_fires - NIFC_annual_fires) for years >= 2000\"]\n    }\n}\n```",
  "system_name": "deepseek",
  "extraction_time_s": 17.713924169540405,
  "token_usage": {
    "input_tokens": 1313,
    "output_tokens": 862
  }
}